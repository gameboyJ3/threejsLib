<html>
<head>

	<meta http-equiv='cache-control' content='no-cache'>
	<meta http-equiv='expires' content='0'>
	<meta http-equiv='pragma' content='no-cache'>
	<meta http-equiv="Pragma" content="no-cache" />
	<meta http-equiv="Expires" content="-1" />
	<meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width, shrink-to-fit=no">
	<style>
    html, body {
        margin: 0;
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: #000;
      }

	#progress {
        width: 0;
        height: 5px;
        position: fixed;
        top: 0;
        background: #fff;
        -webkit-transition: opacity 0.5s ease;
        transition: opacity 0.5s ease;
      }

    #progress.finish {
        opacity: 0;
    }
	
	.centerDiv{
		background:url(Logo/shipdeck.jpg) 30% 50%;
		background-size: cover;
	}
	
	.LinkImage{
		cursor:pointer;
		position:absolute;
		width: 50px;
		height: 50px;
		background:rgba(217,0,0,0.8);
		box-shadow: -1px -1px 11px 1px #ffffff;
		border-radius: 70px;
	}
	
    </style>
	<script src='./js/jquery.min.js'></script>
	<script src='./js/three.min.js'></script>
	<script src='./js/panolens.js?n=1'></script>
	<script src='./js/main.js'></script>
	<script src='./js/data.js'></script>
</head>
<body onload="docOnload()" >



<div class="centerDiv" style="position:absolute;top:0px;left:0px;width:100%;height:100%;z-index:1"> <!-- Make zindex : 1 for normal working>
	<!-- <img src="Logo/shipdeck.jpg" style="position:absolute;top:0px;left:0px;width:100%;height:100%;"> -->
	<img src="Logo/logo.png" style="position:absolute;top:20px;left:20px;width:170px;">
	
	<div onclick="LinkTo360View()" align="center" class="LinkImage link1" style="top:37%;left:30%;">
		 <img src="Logo/360.png" style="width: 100%;height: 100%;"> 
	</div>
	
	<div onclick="LinkTo360View()" align="center" class="LinkImage link2" style="top: 72%;left: 10%;">
		 <img src="Logo/360.png" style="width: 100%;height: 100%;"> 
	</div>
	
	<div onclick="LinkTo360View()" align="center" class="LinkImage link3" style="top:37%;left: 56%;">
		 <img src="Logo/360.png" style="width: 100%;height: 100%;"> 
	</div>
	
	<div onclick="LinkTo360View()" align="center" class="LinkImage link4" style="top: 24%;left: 86%;">
		 <img src="Logo/360.png" style="width: 100%;height: 100%;"> 
	</div>
	
	<!-- <div align="center" class="centerDiv" style="cursor:pointer;position:relative;margin:0 auto;top:40%;width:220px;height:110px;background:rgba(83, 83, 83, 0.3);box-shadow: -1px -1px 11px 1px #cccccc;">
		<img src="Logo/360.png" style="width:100px;height:100px;position:absolute;top:-10px;left:60px;">
		<label style="color:#D6D7D8;font-size:20px;position:absolute;width:200px;top:80px;left:10px;font-family:Arial">Start 360&#176; Virtual Tour</label>
	</div> -->
	
	<!-- <div align="center" class="centerDiv" style="cursor:pointer;position:relative;margin:0 auto;top: 45%;width: 430px;height: 80px;background:rgba(83, 83, 83, 0.3);box-shadow: -1px -1px 11px 1px #cccccc;">
		<img src="Logo/360.png" style="width:100px;height:100px;position:absolute;top:-10px;left: 10px;">
		<label style="color:#D6D7D8;font-size: 40px;position:absolute;width: 300px;top: 20px;left: 115px;font-family:Arial;">Start 360&#176; Virtual Tour</label>
	</div> -->
	
</div>

<div id="progress" style="width: 100%;" class="finish"></div>
<label id="LoadingLabelId" style="position:absolute;display:none;top:40%;left:30%;font-size:40px;color:#eeeeee;z-index:1;">Loading page, Please wait...</label>
<audio id="myAudio">
	<source id="audioSource" src="Audio/1.mp3" type="audio/mpeg"/>
</audio>

<script>
	/*$( "div.centerDiv" )
	  .mouseenter(function() {
		$(this).css("box-shadow","-1px -1px 11px 1px #bbbbbb");
	  })
	  .mouseleave(function() {
		$(this).css("box-shadow","-1px -1px 11px 1px #444444");
	  });*/
	  
	var loadingLabel = document.getElementById('LoadingLabelId');
	var progress;
	var audio = document.getElementById('myAudio');
	var source = document.getElementById('audioSource');
	
	var progressElement = document.getElementById( 'progress' );

	function LinkTo360View()
	{
		$(".centerDiv").css("display","none");
		var shipDeck = new ShipDeck();
		shipDeck.initialize(dataJson);
		$(".panolens-container").append('<img ontouchstart="CloseClickFunction()" onclick="CloseClickFunction()" src="Logo/close.png" style="position:absolute;cursor:pointer;top:10px;right:10px;width:20px;">');
	}
	
	function CloseClickFunction()
	{
		$(".panolens-container").remove();
		$(".centerDiv").css("display","block");
		audio.pause();
	}
	
	var LoadedPanoramas = [];

    function onEnter ( event ) {
		//loadingLabel.style.display = "block";
        progressElement.style.width = 0;
        progressElement.classList.remove( 'finish' );
		if(LoadedPanoramas.includes(event.target.name))
		{
			PlayAudio(event.target.name);
		}
	}
	
	var isFirstTime = false;
	
	function PlayAudio(audioName)
	{
		try{
				source.src = "./Audio/"+audioName+".mp3";
				audio.load(); 
				audio.play();
				isFirstTime = true;
			}
			catch(e)
			{
				console.log("Error : "+e)
			}
	}

    function onProgress ( event ) {
        progress = event.progress.loaded / event.progress.total * 100;
        progressElement.style.width = progress + '%';
        if ( progress === 100 ) {
			if(LoadedPanoramas.length == 0)
			{
				LoadedPanoramas.push(event.target.name);
				PlayAudio(event.target.name);
			}
			else
			{
				if(!LoadedPanoramas.includes(event.target.name))
				{
					LoadedPanoramas.push(event.target.name);
					PlayAudio(event.target.name);
				}
			}
            progressElement.classList.add( 'finish' );
		  //loadingLabel.style.display = "none";
        }
    }
	
	function checkWindowSize()
	{
		if($( window ).width() < 500)
		{
			$(".link4").css("display","none");
			$(".link3").css("top","53%");
			$(".link3").css("left","66%");
		  
		}
		else
		{
			$(".link4").css("display","block");
			$(".link3").css("top","37%");
			$(".link3").css("left","56%");
		}
	}
	
	function docOnload()
	{
		//var shipDeck = new ShipDeck();
		//shipDeck.initialize(dataJson);
		checkWindowSize();
		$( window ).resize(function() {
		  checkWindowSize();
		});
	
		audio.onended = function() {
			//console.log("Audio ended-----");
		};
	}
	
	function ClickToNextPanoImage(pano)
	{
		//console.log("-------------------pano-------------");
		//console.log(pano);
		if(pano.name == "1" || pano.name == "2")
		{
			source.src = "./Audio/"+pano.name+".mp3";
			audio.load(); 
			audio.play();
		}
	}
	function requestOrientation()
	{
		if (typeof DeviceMotionEvent.requestPermission === 'function') {
	    DeviceMotionEvent.requestPermission()
		.then(response => {
		  if (response == 'granted') {
			window.addEventListener('devicemotion', (e) => {
			  // do something with e
			})
		  }
		})
		.catch(console.error)
		} else {
		  // non iOS 13+
		}
	}
	
	
	
	
</script>
</body>
</html>